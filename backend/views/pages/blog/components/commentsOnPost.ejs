<style>
    .showPost .commentsOnPost {
        display: block;
        overflow: scroll;
        /* background-color:#f6d365; */
        border-radius: 5px;
        padding: 10px;
        min-width: 400px;
        margin: 19rem auto;
        position: static;
    }

    .showPost .commentsOnPost .card {
        display: flex;
        margin-bottom: 2rem;
        border-bottom: 1px solid #17a2b8;
        background-color: transparent;
    }

    .showPost .commentsOnPost .card .cardContent {
        padding: 1rem 0 1rem 0;
    }

    .commentsOnPost h2 {
        font-size: clamp(18px, 2vw, 24px);
        margin-bottom: 20px;
    }

    .commentsOnPost textarea {
        width: 100%;
        max-height: 300px;
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 1em;
    }

    .showPost .commentsOnPost #submitButton {
        display: block;
        margin: 10px auto;
        padding: 5px 10px;
        background-color: var(--colorOnBackgroundColor);
        color: var(--colorOnBackground);
        border: none;
        border-radius: 5px;
        font-size: clamp(12px, 1vw, 16px);
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s ease-in-out;
    }

    .showPost .commentsOnPost #submitButton:hover {
        background-color: #f6d365;
    }

    .commentsOnPost img {
        border-radius: 50%;
        width: clamp(25px, 4vw, 35px);
        height: clamp(25px, 4vw, 35px);
        ;
        margin-right: 10px;
    }

    .commentsOnPost .p {
        display: inline-block;
        font-size: clamp(11px, 1vw, 13px);
        margin: 0;
        color: var(--colorOnBackgroundColor);
    }

    .commentsOnPost .comment-content {
        color: var(--colorOnBackgroundColor);
        margin-top: 10px;
        margin-bottom: 20px;
        font-size: clamp(12px, 1vw, 14px);
    }

    .commentsOnPost #editButton,
    .commentsOnPost form button[type="submit"] {
        border: none;
        padding: 5px 5px;
        border-radius: 5px;
        margin-right: 10px;
        cursor: pointer;
        font-size: clamp(14px, 2vw, 18px);
        transition: background-color 0.3s ease;
    }

    .commentsOnPost #editButton:hover,
    .commentsOnPost form button[type="submit"]:hover {
        background-color: #bbb;
    }


    .showPost .commentsOnPost .fa-trash {
        color: #dc3545;
        font-size: clamp(14px, 1vw, 18px);
        background-color: none;
    }

    @media screen and (max-width: 867px) {

        .showPost .commentsOnPost {
            margin: 2rem auto;
            width: 100%;
        }

    }
</style>

<div id="#comment" class="commentsOnPost hidden">
    <h2>Comments (<%= blogpost.comments.length %>)</h2>
    <form method="POST" action="/post/<%= blogpost._id %>/comment?_method=PUT">
        <textarea id="writeCommentOnPost" type="text" name="content" placeholder="What are your thoughts?"></textarea>
        <button id="submitButton" type="submit">Submit</button>
    </form>
    <% for(var i=0; i < blogpost.comments.length; i++) {%>
        <div class="card">
            <div class="cardContent">
                <div class="creater-detail">
                    <img src="<%= blogpost.comments[i].commenterImage %>" alt=" " style=" border-radius:50%"
                        width="50px" height="50%" />
                    <p class="p">
                        <b>
                            <%= blogpost.comments[i].username %>
                        </b>
                        <%= blogpost.comments[i].datePosted.toDateString() %>
                    </p>
                </div>
                <p class="comment-content">
                    <%- blogpost.comments[i].content %>
                </p>

                <% if(blogpost.comments[i].userId.equals(userid)) { %>
                    <form method="POST" action="/post/<%= blogpost.comments[i]._id %>/comment?_method=DELETE">
                        <input type="hidden" name="postId" value="<%= blogpost._id %>" />
                        <button type="submit" class="btn">
                            <i class="fa fa-trash"></i>
                        </button>
                    </form>
                    <% } %>                
            </div>
        </div>
        <% } %>
        <% if(blogpost.comments.length > 3) { %>
            <button id="showMoreComments">Show More</button>
            <button id="showLessComments" style="display: none;">Show Less</button>
        <% } %>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const comments = document.querySelectorAll('.commentsOnPost .card');
        const showMoreBtn = document.getElementById('showMoreComments');
        const showLessBtn = document.getElementById('showLessComments');
        let increment = 2; // Number of comments to show/hide per click
        let visibleCount = 3; // Initially visible comments
    
        // Initially show the first set of comments
        comments.forEach((comment, index) => {
            comment.style.display = index < visibleCount ? '' : 'none';
        });
    
        // Update the visibility of the "Show Less" button
        function updateShowLessButton() {
            showLessBtn.style.display = visibleCount > 3 ? '' : 'none';
        }
    
        // Show More functionality
        showMoreBtn.addEventListener('click', function () {
            visibleCount = Math.min(visibleCount + increment, comments.length);
            comments.forEach((comment, index) => {
                comment.style.display = index < visibleCount ? '' : 'none';
            });
            if (visibleCount === comments.length) {
                showMoreBtn.style.display = 'none';
            }
            updateShowLessButton();
        });
    
        // Show Less functionality
        showLessBtn.addEventListener('click', function () {
            visibleCount = Math.max(visibleCount - increment, 3);
            comments.forEach((comment, index) => {
                comment.style.display = index < visibleCount ? '' : 'none';
            });
            if (visibleCount <= 3) {
                showLessBtn.style.display = 'none';
            }
            showMoreBtn.style.display = '';
        });
    
        // Initially update the "Show Less" button visibility
        updateShowLessButton();
    });
    </script>
    